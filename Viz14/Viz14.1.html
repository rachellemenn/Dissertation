<!DOCTYPE html>
<meta charset="utf-8">
<!-- <svg width="600" height="520" margin = {top: 0, left: 20, bottom: 40, right: 10}/> -->
<style>
    body {
        text-align: center;
    }
</style>

<body>
        <form>
                <label><input type="radio" name="dataset" value="apples" checked> Religion</label>
                <label><input type="radio" name="dataset" value="oranges"> Generation</label>
              </form>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
    //  <form>
    // <label><input type="radio" name="dataset" value="apples" checked> Apples</label>
    // <label><input type="radio" name="dataset" value="oranges"> Oranges</label>
    // </form>
        // Define the data as a two-dimensional array of numbers. If you had other
        // data to associate with each number, replace each number with an object, e.g.,
        // `{key: "value"}`.
    var Religion = {};
    var Generation = {};

    function cleanupContent() {
            svg.remove();
        }

        function loadData(fileName) {
            return d3.csv(fileName);
        }
        
        // var data = [
        //       [0.5298, 0.4708],
        //       [ 0.5321, 0.4679],
        //  	    [ 0.5826, 0.4174],
        // 	    [ 0.6974,0.3026]

        

        var dataPromise = loadData(data);
        dataPromise.then(function (data) {
            console.log(data);
            data.forEach(function (d) {
                d.Value = parseFloat(d.Value)
            });

            console.log(data);

            var rel = [
                [],
                []
            ];

            /*data.forEach((d) => {
                var index = d.Religion == 'R' ? 0 : 1;
                rel[index].push({
                    name: d.Generation,
                    value: d.Value * 100
                });
            });*/

            data.forEach((d) => {
                var index = d.WithJew == 'Yes' ? 0 : 1;
                rel[index].push(d.Value);
            });

            console.log(rel);

            //var arcs = pie(data);

            //Rachelle's comment: changed the data

            // Define the margin, radius, and color scale. The color scale will be
            // assigned by index, but if you define your data using objects, you could pass
            // in a named field from the data object instead, such as `d.name`. Colors
            // are assigned lazily, so if you want deterministic behavior, define a domain
            // for the color scale.
            var m = 10,
                r = 100,
                //z = d3.scaleOrdinal()
                //    .range(["#0077b3", "#66ccff",]);
                z = d3.scaleOrdinal()
                .range([
                    "#0077b3", "#0099e6", "#1ab2ff", "#66ccff",
                ]);
            //Rachelle's comment: changed colors and scaleOrdinal for v5 

            // Insert an svg element (with margin) for each row in our dataset. A child g
            // element translates the origin to the pie center.
            var svg = d3.select("body").selectAll("svg")
                .data(rel)
                .enter().append("svg")
                .attr("width", (r + m) * 2)
                .attr("height", (r + m) * 2)
                .append("g")
                .attr("transform", "translate(" + (r + m) + "," + (r + m) + ")");

            // The data for each svg element is a row of numbers (an array). We pass that to
            // d3.layout.pie to compute the angles for each arc. These start and end angles
            // are passed to d3.svg.arc to draw arcs! Note that the arc radius is specified
            // on the arc, not the layout.
            //Rachelle's comment: updated d3.pie and d3.arc to v5
            svg.selectAll("path")
                .data(d3.pie())
                .enter().append("path")
                .attr("d", d3.arc()
                    .innerRadius(r / 2)
                    .outerRadius(r))
                .style("fill", function (d, i) {
                    return z(i);
                });
        })
    Religion.addEventListener("click", function() { loadData("VIZual14.csv"); });
    Generation.addEventListener("click", function() { loadData("Vizual14.1.csv"); });
    </script>